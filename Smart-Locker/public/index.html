<!doctype html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Virtual self-service locker</title>

  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Quicksand', 'sans-serif'] },
          colors: {
            oatLatte: '#EAE0D5',
            warmBrown: '#4A3326',
            sunrise: '#E67E22',
            amberGlow: '#F39C12',
            sageGreen: '#5A7D6C',
          }
        }
      }
    }
  </script>

  <style>
    body { background-color: #EAE0D5; color: #4A3326; overflow: hidden; height: 100vh; display: flex; align-items: center; }
    .glass-card{ background: rgba(255,255,255,.75); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,.9); box-shadow: 0 15px 35px rgba(74,51,38,.10); }
    .chip{ border: 1px solid rgba(74,51,38,.12); background: rgba(255,255,255,.6); }
    .hidden{ display:none !important; }

    .kiosk{ width: min(1500px, 100%); height: 100%; max-height: 960px; margin: 0 auto; padding: 18px 18px 26px; display: flex; flex-direction: column; }
    .locker-machine{ display:grid; grid-template-columns: 1fr 380px; gap: 22px; align-items: stretch; flex: 1; height: 100%; min-height: 0; }
    @media (max-width: 1100px){ .locker-machine{ grid-template-columns: 1fr; } }

    /* -------- Big locker cabinet (LEFT) -------- */
    .cabinet-wrap{ position:relative; border-radius: 38px; overflow:hidden; perspective: 2600px; height: 100%; }
    #locker.locker{ position: relative; width: 100%; height: 100%; border-radius: 38px; border: 10px solid rgba(255,255,255,.92); box-shadow: 0 58px 160px rgba(74,51,38,.26); background: linear-gradient(180deg, rgba(255,255,255,.92), rgba(234,224,213,.78)); overflow: hidden; transition: transform 0.8s cubic-bezier(0.34, 1.3, 0.64, 1); }
    #locker.locker::before{ content:""; position:absolute; inset:-2px; background: radial-gradient(1100px 680px at 10% -10%, rgba(230,126,34,.22), transparent 60%), radial-gradient(1100px 680px at 110% 20%, rgba(90,125,108,.18), transparent 62%), linear-gradient(180deg, rgba(255,255,255,.65), rgba(255,255,255,0)); opacity:.95; pointer-events:none; mask: linear-gradient(#000, transparent 86%); }

    .cabinet-top{ position: relative; padding: 18px 22px 10px; display:flex; align-items:flex-end; justify-content: space-between; gap: 12px; }
    .cabinet-brand{ display:inline-flex; align-items:center; gap: 10px; padding: 10px 14px; border-radius: 999px; border: 1px solid rgba(74,51,38,.14); background: rgba(255,255,255,.62); box-shadow: inset 0 0 0 2px rgba(255,255,255,.55); font-weight: 900; letter-spacing: .18em; text-transform: uppercase; color: rgba(74,51,38,.88); font-size: 12px; white-space: nowrap; }
    .cabinet-brand .dot{ width: 10px; height: 10px; border-radius: 999px; background: rgba(230,126,34,.85); box-shadow: 0 0 0 6px rgba(230,126,34,.14); }
    .cabinet-meta{ text-align:right; font-weight: 800; color: rgba(74,51,38,.55); font-size: 12px; letter-spacing: .08em; text-transform: uppercase; }

    .compartment-area{ position: relative; padding: 18px 22px 26px; height: calc(100% - 66px); display:flex; }
    .compartment-frame{ position: relative; width: 100%; height: 100%; border-radius: 30px; border: 2px solid rgba(74,51,38,.14); background: rgba(255,255,255,.52); box-shadow: inset 0 0 0 2px rgba(255,255,255,.55), 0 26px 70px rgba(74,51,38,.14); overflow:hidden; }
    .compartment-frame::before{ content:""; position:absolute; inset:0; background: linear-gradient(0deg, rgba(255,255,255,.45), rgba(255,255,255,0)), repeating-linear-gradient(90deg, rgba(74,51,38,.075), rgba(74,51,38,.075) 2px, transparent 2px, transparent 22px), repeating-linear-gradient(0deg, rgba(74,51,38,.06), rgba(74,51,38,.06) 1px, transparent 1px, transparent 18px); opacity:.32; pointer-events:none; mask: radial-gradient(1200px 900px at 50% 35%, #000 40%, transparent 78%); }

    /* --- 內部空間 --- */
    .locker-cavity{ position:absolute; inset: 18px; border-radius: 22px; background: radial-gradient(760px 520px at 50% 65%, rgba(90,125,108,.34), transparent 64%), radial-gradient(820px 560px at 45% 55%, rgba(230,126,34,.22), transparent 70%), linear-gradient(180deg, rgba(74,51,38,.22), rgba(74,51,38,.08)); border: 2px solid rgba(255,255,255,.28); box-shadow: inset 0 26px 90px rgba(0,0,0,.22); display:flex; flex-direction: column; align-items:center; justify-content:center; gap: 14px; opacity: 0; transform: translateY(6px) scale(.995); transition: opacity .28s ease, transform .55s ease; overflow:hidden; }
    .locker-cavity::before{ content:""; position:absolute; inset:0; background: repeating-linear-gradient(90deg, rgba(255,255,255,.12), rgba(255,255,255,.12) 2px, transparent 2px, transparent 26px), repeating-linear-gradient(0deg, rgba(0,0,0,.10), rgba(0,0,0,.10) 1px, transparent 1px, transparent 16px), radial-gradient(900px 640px at 50% 40%, transparent 55%, rgba(0,0,0,.28) 100%); opacity:.35; pointer-events:none; mix-blend-mode: overlay; z-index: 0;}
    .locker-cavity::after { content: ""; position: absolute; inset: -50%; background: radial-gradient(circle at center, rgba(243,156,18,0.4) 0%, transparent 60%); opacity: 0; pointer-events: none; mix-blend-mode: screen; z-index: 1; }
    .locker-cavity img{ width: min(78%, 620px); aspect-ratio: 4 / 3; object-fit: cover; border-radius: 18px; border: 2px solid rgba(255,255,255,.70); box-shadow: 0 18px 48px rgba(0,0,0,.30); opacity: 0; transform: translateY(10px) scale(.985); transition: opacity .55s ease, transform .6s cubic-bezier(0.34, 1.3, 0.64, 1); background: rgba(255,255,255,.18); position: relative; z-index: 2; }
    .locker-cavity .inside-label{ font-weight: 900; letter-spacing: .12em; color: rgba(255,255,255,.96); text-shadow: 0 14px 30px rgba(74,51,38,.48); padding: 10px 18px; border-radius: 999px; border: 1px solid rgba(255,255,255,.35); background: rgba(90,125,108,.62); position: relative; z-index: 2; }

    /* --- 櫃門設定 --- */
    .locker-door{ position:absolute; inset: 10px; border-radius: 24px; transform-origin: left center; transform: rotateY(0deg) translateZ(0); transition: transform 1.2s cubic-bezier(0.34, 1.3, 0.64, 1), box-shadow 1.2s ease; will-change: transform; border: 2px solid rgba(255,255,255,.92); background: linear-gradient(180deg, rgba(255,255,255,.92), rgba(234,224,213,.76)), repeating-linear-gradient(90deg, rgba(74,51,38,.14), rgba(74,51,38,.14) 2px, transparent 2px, transparent 24px), repeating-linear-gradient(0deg, rgba(74,51,38,.10), rgba(74,51,38,.10) 1px, transparent 1px, transparent 18px); box-shadow: 0 28px 88px rgba(74,51,38,.20), inset -18px 0 40px rgba(0,0,0,.12); overflow:hidden; z-index: 10; }
    .locker-door::before{ content:""; position:absolute; inset: 16px; border-radius: 20px; border: 2px dashed rgba(74,51,38,.14); opacity: .95; pointer-events:none; }
    .locker-door::after{ content:""; position:absolute; top: 10px; bottom: 10px; left: -12px; width: 16px; border-radius: 14px; background: linear-gradient(180deg, rgba(200,200,200,.78), rgba(120,120,120,.52)); box-shadow: 0 12px 22px rgba(0,0,0,.18); transform: translateZ(-1px); opacity: .55; }
    .door-badge{ position:absolute; left: 18px; top: 18px; padding: 10px 14px; border-radius: 999px; background: rgba(255,255,255,.70); border: 1px solid rgba(74,51,38,.14); font-weight: 900; letter-spacing: .16em; color: rgba(74,51,38,.78); font-size: 12px; text-transform: uppercase; user-select:none; }
    .locker-handle{ position:absolute; right: 18px; top: 50%; transform: translateY(-50%); width: 18px; height: 110px; border-radius: 999px; background: linear-gradient(180deg, rgba(230,126,34,.92), rgba(243,156,18,.90)); box-shadow: 0 14px 34px rgba(230,126,34,.26); }
    .locker-handle::after{ content:""; position:absolute; inset: 12px 5px; border-radius: 999px; background: rgba(255,255,255,.38); opacity: .9; }
    .door-hint{ position:absolute; right: 54px; top: 18px; padding: 10px 14px; border-radius: 999px; background: rgba(234,224,213,.88); border: 1px solid rgba(74,51,38,.12); font-weight: 900; letter-spacing: .10em; color: rgba(74,51,38,.62); font-size: 11px; text-transform: uppercase; user-select:none; }

    #locker.locker.open { animation: cabinetPop 0.8s cubic-bezier(0.34, 1.3, 0.64, 1) forwards; }
    #locker.locker.open .locker-door { transform: rotateY(-130deg) translateZ(40px); box-shadow: 0 42px 120px rgba(74,51,38,.35), inset -22px 0 46px rgba(0,0,0,.14); }
    #locker.locker.open .locker-cavity { opacity: 1; transform: translateY(0) scale(1); }
    #locker.locker.open .locker-cavity img { opacity: 1; transform: translateY(0) scale(1.04); }
    #locker.locker.open .locker-cavity::after { animation: innerGlowPulse 2s ease-in-out infinite alternate; }

    @keyframes cabinetPop { 0% { transform: scale(1) translateY(0); } 40% { transform: scale(1.02) translateY(-4px); box-shadow: 0 70px 180px rgba(74,51,38,.35); } 100% { transform: scale(1.015) translateY(0); box-shadow: 0 60px 170px rgba(74,51,38,.30); } }
    @keyframes innerGlowPulse { 0% { opacity: 0; transform: scale(0.8); } 100% { opacity: 1; transform: scale(1.1); } }

    .open-burst{ position:absolute; inset: 0; pointer-events:none; opacity: 0; transform: scale(.98); border-radius: 38px; z-index: -1; }
    #locker.locker.open + .open-burst{ animation: burst 900ms ease-out forwards; }
    @keyframes burst{ 0%{ opacity:0; transform: scale(.96); } 30%{ opacity:1; } 100%{ opacity:0; transform: scale(1.02); } }

    /* -------- RIGHT panel -------- */
    .right-panel { border-radius: 34px; display: flex; flex-direction: column; height: 100%; overflow: hidden; }
    section { display: flex; flex-direction: column; flex: 1; min-height: 0; width: 100%; }

    .scroll-area { flex: 1; overflow-y: auto; min-height: 0; padding-right: 8px; margin-top: 16px; margin-bottom: 12px; scrollbar-width: thin; scrollbar-color: rgba(74,51,38,.25) transparent; }
    .scroll-area::-webkit-scrollbar { width: 6px; }
    .scroll-area::-webkit-scrollbar-track { background: transparent; }
    .scroll-area::-webkit-scrollbar-thumb { background-color: rgba(74,51,38,.25); border-radius: 10px; }

    .panel-title, .bottom-action { flex-shrink: 0; }
    .panel-title{ display:flex; align-items:flex-start; justify-content: space-between; gap: 14px; }
    .panel-hint{ font-size: 12px; font-weight: 900; letter-spacing: .12em; text-transform: uppercase; color: rgba(74,51,38,.55); }
    
    .qr-img{ width: 100%; aspect-ratio: 1/1; object-fit: contain; border-radius: 26px; border: 3px solid rgba(255,255,255,.92); box-shadow: 0 18px 44px rgba(74,51,38,.16); background: rgba(255,255,255,.62); }

    .locker-led{ width: 16px; height: 16px; border-radius: 999px; background: rgba(74,51,38,.18); box-shadow: 0 0 0 7px rgba(74,51,38,.08); }
    .locker-led.ready{ background: rgba(243,156,18,.95); box-shadow: 0 0 0 7px rgba(243,156,18,.18), 0 0 26px rgba(243,156,18,.35); }
    .locker-led.open{ background: rgba(49,208,123,.95); box-shadow: 0 0 0 7px rgba(49,208,123,.16), 0 0 32px rgba(49,208,123,.35); }

    #step-burn:not(.hidden) ~ #step-select{ display:none !important; }
    #step-burn:not(.hidden) ~ #step-login{ display:none !important; }
    #step-select:not(.hidden) ~ #step-login{ display:none !important; }

    /* ★ 修改成自動置中排版 */
    .nft-grid{ 
      display: grid; 
      grid-template-columns: repeat(auto-fit, 140px); /* 固定每個卡片大小，自動斷行 */
      justify-content: center; /* 讓整個 grid 網格在容器內水平置中 */
      gap: 16px; 
    }
    
    .nft-card{ border-radius: 22px; overflow:hidden; border: 2px solid rgba(255,255,255,.9); background: rgba(255,255,255,.72); box-shadow: 0 14px 30px rgba(74,51,38,.10); transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease; cursor:pointer; }
    .nft-card:hover{ transform: translateY(-4px); box-shadow: 0 22px 40px rgba(74,51,38,.14); border-color: rgba(230,126,34,.55); }
    .nft-card.selected{ border-color: rgba(90,125,108,.75); box-shadow: 0 24px 44px rgba(90,125,108,.16); }
    .nft-thumb{ width:100%; aspect-ratio: 1/1; object-fit: cover; background: rgba(234,224,213,.55); }
    .nft-meta{ padding: 12px 12px 14px; }
    .nft-name{ font-weight: 800; color: rgba(74,51,38,.95); line-height: 1.15; }
    .nft-id{ font-size: 12px; color: rgba(74,51,38,.60); margin-top: 6px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    .preview img{ width: 108px; height: 108px; border-radius: 18px; object-fit: cover; border: 2px solid rgba(255,255,255,.9); box-shadow: 0 12px 26px rgba(74,51,38,.12); background: rgba(255,255,255,.7); }
  </style>
</head>

<body class="antialiased font-sans">
  <div class="kiosk">
    <div class="locker-machine">
      <div class="cabinet-wrap">
        <div id="locker" class="locker">
          <div class="cabinet-top">
            <div class="cabinet-brand"><span class="dot"></span> Smart Locker</div>
            <div class="cabinet-meta">kiosk mode<br/>scan → select → burn → open</div>
          </div>

          <div class="compartment-area">
            <div class="compartment-frame">
              <div class="locker-cavity">
                <img id="locker-inside-img" alt="inside" />
                <div class="inside-label">PICKUP READY</div>
              </div>
              <div class="locker-door">
                <div class="door-badge">A-05</div>
                <div class="door-hint">SELF PICKUP</div>
                <div class="locker-handle"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="open-burst"></div>
      </div>

      <aside class="glass-card p-6 md:p-7 right-panel">
        
        <section id="step-burn" class="hidden">
          <div class="panel-title shrink-0">
            <div>
              <div class="panel-hint text-sunrise">STEP 3</div>
              <div class="text-2xl md:text-3xl font-extrabold text-warmBrown mt-1">Scan to Open</div>
              <div class="text-sm font-semibold text-warmBrown/65 mt-2">Scan with Xaman to confirm Burn transaction</div>
            </div>
            <div class="text-right">
              <div class="panel-hint mb-2">LED</div>
              <div id="locker-led" class="locker-led ready ml-auto"></div>
            </div>
          </div>

          <div class="scroll-area flex flex-col gap-5">
            <div class="mx-auto w-full max-w-[260px] shrink-0 mt-2">
              <img id="burn-qr" class="qr-img" alt="burn qr" />
            </div>
            
            <div class="glass-card p-5 rounded-[1.75rem] shrink-0">
              <div class="text-sm font-bold text-sageGreen uppercase tracking-wider mb-2">Burn Status</div>
              <div id="burn-status" class="text-xl font-bold text-warmBrown/85">Waiting for signature…</div>

              <div class="mt-5 text-sm font-bold text-amberGlow uppercase tracking-wider mb-2">Locker Status</div>
              <div id="unlock-status" class="text-xl font-bold text-warmBrown/85">—</div>
            </div>
          </div>
        </section>

        <section id="step-select" class="hidden">
          <div class="panel-title shrink-0">
            <div>
              <div class="panel-hint text-sunrise">STEP 2</div>
              <div class="text-2xl md:text-3xl font-extrabold text-warmBrown mt-1">Product List</div>
              <div class="text-sm font-semibold text-warmBrown/65 mt-2">
                Available: <span id="nft-count" class="text-sunrise font-extrabold">0</span>
              </div>
            </div>
            </div>

          <div class="scroll-area flex flex-col gap-4">
            <div class="glass-card p-5 rounded-[1.75rem] shrink-0">
              <div class="text-sm font-bold text-sageGreen uppercase tracking-wider mb-4 text-center">NFT List (Tap to Redeem)</div>
              <div id="nft-grid" class="nft-grid"></div>
            </div>

            <div class="glass-card p-5 rounded-[1.75rem] space-y-4 shrink-0 hidden">
              <select id="nft-select" class="w-full hidden"></select>
              <div>
                <div class="text-sm font-bold text-amberGlow uppercase tracking-wider mb-2">Selected Preview</div>
                <div id="nft-preview" class="preview flex gap-3 items-start flex-wrap"></div>
              </div>
            </div>
          </div>
        </section>

        <section id="step-login">
          <div class="panel-title shrink-0">
            <div>
              <div class="panel-hint text-sunrise">STEP 1</div>
              <div class="text-2xl md:text-3xl font-extrabold text-warmBrown mt-1">Login Wallet</div>
              <div class="text-sm font-semibold text-warmBrown/65 mt-2">Scan QR to login. Auto-proceeds to Step 2</div>
            </div>
            </div>

          <div class="scroll-area flex flex-col gap-5">
            <div class="mx-auto w-full max-w-[260px] shrink-0 mt-2">
              <img id="login-qr" class="qr-img" alt="login qr">
            </div>

            <div class="glass-card p-5 rounded-[1.75rem] space-y-4 shrink-0">
              <div class="grid gap-2">
                <div class="text-sm font-bold text-amberGlow uppercase tracking-wider">Login UUID</div>
                <div id="login-uuid" class="font-semibold text-warmBrown/80 break-all text-sm"></div>
              </div>
              <div class="grid gap-2">
                <div class="text-sm font-bold text-sageGreen uppercase tracking-wider">Status</div>
                <div id="login-status" class="font-semibold text-warmBrown/80">Waiting for scan…</div>
              </div>
              <div class="grid gap-2">
                <div class="text-sm font-bold text-sunrise uppercase tracking-wider">Account</div>
                <div id="login-account" class="font-semibold text-warmBrown/80 break-all text-sm"></div>
              </div>
            </div>
          </div>
        </section>
        
      </aside>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>